# -*- coding: utf-8 -*-
"""–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/18wCCDeyurK_2IAOOMpm9567JHH1uArV0

## –ü—Ä–æ–µ–∫—Ç: –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞ –∞—Ä–µ–Ω–¥—ã —Å–∞–º–æ–∫–∞—Ç–æ–≤

**–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞:**  
–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –∏ –∏—Ö –ø–æ–µ–∑–¥–∫–∞—Ö –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–∏–ø–æ—Ç–µ–∑, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø–æ–º–æ—á—å –±–∏–∑–Ω–µ—Å—É –≤—ã—Ä–∞—Å—Ç–∏.


**–ö–ª—é—á–µ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –≥–∏–ø–æ—Ç–µ–∑—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
1. –ö–∞–∫ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π Ultra –∏ –±–µ–∑ –Ω–µ–µ?
2. –í–ª–∏—è–µ—Ç –ª–∏ —Ç–∏–ø –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –¥–∏—Å—Ç–∞–Ω—Ü–∏—é –ø–æ–µ–∑–¥–æ–∫?
3. –ù–∞—Å–∫–æ–ª—å–∫–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞ —Ç–µ–∫—É—â–∞—è —Ç–∞—Ä–∏—Ñ–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞?
4. –ö–∞–∫–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–∏–Ω–æ—Å—è—Ç –±–æ–ª—å—à–µ –≤—ã—Ä—É—á–∫–∏ –Ω–∞ –æ–¥–Ω—É –ø–æ–µ–∑–¥–∫—É?
5. –ï—Å—Ç—å –ª–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ç–∞—Ä–∏—Ñ–∞ free –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É Ultra?

**–û–ø–∏—Å–∞–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–æ–≤:**
- **–ë–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏ (free):**  
  - –°—Ç–∞—Ä—Ç –ø–æ–µ–∑–¥–∫–∏: 50 ‚ÇΩ  
  - –ú–∏–Ω—É—Ç–∞ –ø–æ–µ–∑–¥–∫–∏: 8 ‚ÇΩ  
  - –ê–±–æ–Ω–µ–Ω—Ç—Å–∫–∞—è –ø–ª–∞—Ç–∞: 0 ‚ÇΩ

- **–° –ø–æ–¥–ø–∏—Å–∫–æ–π Ultra:**  
  - –°—Ç–∞—Ä—Ç –ø–æ–µ–∑–¥–∫–∏: 0 ‚ÇΩ  
  - –ú–∏–Ω—É—Ç–∞ –ø–æ–µ–∑–¥–∫–∏: 6 ‚ÇΩ  
  - –ê–±–æ–Ω–µ–Ω—Ç—Å–∫–∞—è –ø–ª–∞—Ç–∞: 199 ‚ÇΩ/–º–µ—Å

**–ü–ª–∞–Ω –∞–Ω–∞–ª–∏–∑–∞:**
1. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –æ—Å–º–æ—Ç—Ä –∏ –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
2. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
3. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–∞—Ö
4. –ê–Ω–∞–ª–∏–∑ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –≥–∏–ø–æ—Ç–µ–∑
6. –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –≤—ã–≤–æ–¥–æ–≤ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
"""

from google.colab import files
uploaded = files.upload()

"""## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –æ—Å–º–æ—Ç—Ä –∏ –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö"""

import pandas as pd
import matplotlib.pyplot as plt
from scipy import stats as st
from math import sqrt, factorial
import numpy as np
from scipy.stats import binom, norm

data_users = pd.read_csv('users_go.csv')
data_riders = pd.read_csv('rides_go.csv')
data_subscriptions = pd.read_csv('subscriptions_go.csv')

data_users.head(10)

data_riders.head(10)

data_subscriptions.head()

data_users.info()

data_riders.info()

data_subscriptions.info()

"""### –í—ã–≤–æ–¥ –ø–æ –¥–∞–Ω–Ω—ã–º

–ü—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–π –ø–µ—Ä–≤–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ç—Ä–µ—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ö–æ—Ä–æ—à–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞: –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –æ–∂–∏–¥–∞–Ω–∏—è–º, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø—Ä–æ–ø—É—Å–∫–∏ –≤ —Ä–∞–º–∫–∞—Ö –∫–∞–∂–¥–æ–≥–æ –Ω–∞–±–æ—Ä–∞, –∞ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤ —Ü–µ–ª–æ–º –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**

1.  **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:** –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–¥–∞—á–µ–π –±—É–¥–µ—Ç –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —ç—Ç–∏—Ö —Ç—Ä–µ—Ö —Ç–∞–±–ª–∏—Ü. –î–ª—è —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—â–∏–µ –∫–ª—é—á–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `user_id` –¥–ª—è —Å–≤—è–∑–∏ `data_users` –∏ `data_riders`, `subscription_type` –¥–ª—è —Å–≤—è–∑–∏ `data_users` –∏ `data_subscriptions`).

2.  **–ú–∞—Å—à—Ç–∞–± –¥–∞–Ω–Ω—ã—Ö:**
    *   **data_riders** ‚Äî —ç—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ñ–∞–∫—Ç–æ–≤ (18068 –∑–∞–ø–∏—Å–µ–π), —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –¥–µ—Ç–∞–ª–∏ –ø–æ–µ–∑–¥–æ–∫.
    *   **data_users** ‚Äî —Ç–∞–±–ª–∏—Ü–∞-—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º (1565 –∑–∞–ø–∏—Å–µ–π).
    *   **data_subscriptions** ‚Äî –Ω–µ–±–æ–ª—å—à–æ–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ç–∞—Ä–∏—Ñ–æ–≤ (2 –∑–∞–ø–∏—Å–∏), –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ–µ–∑–¥–æ–∫.

3.  **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:** –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –ø–æ–∑–≤–æ–ª–∏—Ç –ø—Ä–æ–≤–µ—Å—Ç–∏ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑, –Ω–∞–ø—Ä–∏–º–µ—Ä:
    *   –ò–∑—É—á–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Å—Ä–µ–¥–Ω—è—è –¥–∏—Å—Ç–∞–Ω—Ü–∏—è, –≤—Ä–µ–º—è –ø–æ–µ–∑–¥–∫–∏) –≤ —Ä–∞–∑—Ä–µ–∑–µ –ø–æ–¥–ø–∏—Å–∫–∏, –≤–æ–∑—Ä–∞—Å—Ç–∞ –∏ –≥–æ—Ä–æ–¥–∞.
    *   –†–∞—Å—á–µ—Ç –≤—ã—Ä—É—á–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.
    *   –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –∏ –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞.

**–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:** –î–∞–Ω–Ω—ã–µ —á–∏—Å—Ç—ã–µ –∏ —Ö–æ—Ä–æ—à–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω—ã. –°–ª–µ–¥—É—é—â–∏–º –ª–æ–≥–∏—á–Ω—ã–º —à–∞–≥–æ–º —è–≤–ª—è–µ—Ç—Å—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–æ–≤ –≤ –µ–¥–∏–Ω—É—é –º–æ–¥–µ–ª—å –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.

## –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
"""

data_riders['date'] = pd.to_datetime(data_riders['date'], format = '%Y-%m-%d')

data_riders['date'].dt.year.unique()

data_riders['month'] = data_riders['date'].dt.month

data_riders['month'].unique()

data_users.duplicated().sum()

data_riders.duplicated().sum()

data_subscriptions.duplicated().sum()

data_users = data_users.drop_duplicates()

data_users.duplicated().sum()

"""–ü—Ä–æ–≤–µ—Ä–∏–ª–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è"""

data_users.isna().sum()

data_riders.isna().sum()

data_subscriptions.isna().sum()

data_users.info()

data_riders.info()

data_subscriptions.info()

"""**–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —à–∞–≥–∏:**

1.  **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö:**
    *   –°—Ç–æ–ª–±–µ—Ü `date` –≤ `data_riders` —É—Å–ø–µ—à–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω –≤ —Ç–∏–ø `datetime64`. –≠—Ç–æ **–∫–ª—é—á–µ–≤–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ**, –∫–æ—Ç–æ—Ä–æ–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ (–∞–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤, —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏, –∞–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ –¥–Ω—è–º, –Ω–µ–¥–µ–ª—è–º, –º–µ—Å—è—Ü–∞–º).

2.  **–û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
    *   –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü `month`. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ä–∞–∑—É –ø–µ—Ä–µ–π—Ç–∏ –∫ –∞–Ω–∞–ª–∏–∑—É –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–∑—Ä–µ–∑–µ –º–µ—Å—è—Ü–µ–≤ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –¥–∞—Ç—É.

3.  **–ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞:**
    *   –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏ —è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤–æ –≤—Å–µ—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞—Ö. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ —è–≤–ª—è—é—Ç—Å—è –ø–æ–ª–Ω—ã–º–∏ –∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –æ—á–µ–≤–∏–¥–Ω—ã—Ö —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π.

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–∞—Ö
"""

display(data_riders['distance'].head(3))
data_riders['distance'] = data_riders['distance'].round(2)
data_riders['distance'].head(3)

data_riders['distance'].describe()

data_users['city'].unique()

city_count = data_users['city'].value_counts()

city_count

city_count.plot(kind='bar', figsize=(15,10), title='–ß–∞—Å—Ç–æ—Ç–∞ –≤—Å—Ç—Ä–µ—á–∞–µ–º–æ—Å—Ç–∏ –≥–æ—Ä–æ–¥–æ–≤', xlabel='–ù–∞–∑–≤–∞–Ω–∏—è –≥–æ—Ä–æ–¥–æ–≤', ylabel='–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')

tmp = data_users.copy()

ax = tmp['city'].value_counts(ascending=True).plot(
    kind='barh',
    figsize=(15, 5),
    title='–ì—Ä–∞—Ñ–∏–∫ —á–∞—Å—Ç–æ—Ç—ã –≤—Å—Ç—Ä–µ—á–∞–µ–º–æ—Å—Ç–∏ –≥–æ—Ä–æ–¥–æ–≤'
)

for p in ax.patches:
    width = p.get_width()
    ax.annotate(f'{width}',
                (width, p.get_y() + p.get_height() / 2.),
                ha='left', va='center',
                xytext=(5, 0),
                textcoords='offset points')

plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')
plt.ylabel('–ì–æ—Ä–æ–¥')

plt.show()

subscription_count = data_users['subscription_type'].value_counts()

subscription_count

subscription_count.plot(kind='pie', figsize=(5,5), title='–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –∏ –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏', autopct= "%.0ff", ylabel='–ü—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ')

labels = ['–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è', '–ü–ª–∞—Ç–Ω–∞—è']

subscription_count.plot(
    kind='pie',
    figsize=(5, 5),
    title='–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –∏ –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏',
    autopct='%.0f%%',
    labels=labels,
    ylabel='–ü—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ'
)
plt.show()

data_users.value_counts('age')

data_users['age'].hist(bins=30)
plt.title('–í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏')
plt.xlabel('–í–æ–∑—Ä–∞—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')
plt.show()

data_users['age'].describe()

data_riders['distance'].hist(bins=40)
plt.title('–†–∞—Å—Å—Ç–æ—è–Ω–∏—è –ø–æ–µ–∑–¥–æ–∫')
plt.xlabel('–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ –º–µ—Ç—Ä–∞—Ö')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')
plt.show()

data_riders['distance'].describe()

data_riders['duration'].hist(bins=30)
plt.title('–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–µ–∑–¥–æ–∫')
plt.xlabel('–í—Ä–µ–º—è –ø–æ–µ–∑–¥–∫–∏')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')
plt.show()

data_riders['duration'].describe()

data_users_riders = data_users.merge(data_riders, on='user_id')

data_users_riders_final = data_users_riders.merge(data_subscriptions, on='subscription_type')

data_users_riders_final.head()

data_users_riders_final.info()

data_users_free = data_users_riders_final.loc[data_users_riders['subscription_type']=='free']

data_users_free.head()

data_users_free.info()

data_users_ultra = data_users_riders_final.loc[data_users_riders['subscription_type']=='ultra']

data_users_ultra.head()

data_users_ultra.info()

data_users_free.plot(x='distance', y='duration', kind='scatter', figsize=(15,10), alpha=0.7)
plt.title('–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ –∏ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–µ–∑–¥–æ–∫ –ø–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏')
plt.xlabel('–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –ø–æ–µ–∑–¥–∫–∏')
plt.ylabel('–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–µ–∑–¥–∫–∏')
plt.show()

data_users_ultra.plot(x='distance', y='duration', kind='scatter', figsize=(15,10), alpha=0.7)
plt.title('–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ –∏ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–µ–∑–¥–æ–∫ –ø–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π')
plt.xlabel('–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –ø–æ–µ–∑–¥–∫–∏')
plt.ylabel('–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–µ–∑–¥–∫–∏')
plt.show()

plt.hist(data_users_free['distance'], bins=30, label='–±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏')
plt.hist(data_users_ultra['distance'], bins=30, label='—Å –ø–æ–¥–ø–∏—Å–∫–æ–π', alpha=0.8)
plt.xlabel('–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ –º–µ—Ç—Ä–∞—Ö')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')
plt.legend()
plt.show()

plt.hist(data_users_free['duration'], bins=30, label='–±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏')
plt.hist(data_users_ultra['duration'], bins=30, label='—Å –ø–æ–¥–ø–∏—Å–∫–æ–π', alpha=0.8)
plt.xlabel('–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–µ–∑–¥–∫–∏ –≤ –º–∏–Ω—É—Ç–∞—Ö')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')
plt.legend()
plt.show()

"""**–í—ã–≤–æ–¥—ã:**

1.  **–û–±—â–∞—è –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å:** –ù–∞–±–ª—é–¥–∞–µ—Ç—Å—è –ø—Ä—è–º–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –¥–∏—Å—Ç–∞–Ω—Ü–∏–µ–π –∏ –≤—Ä–µ–º–µ–Ω–µ–º –ø–æ–µ–∑–¥–∫–∏, —á—Ç–æ –ª–æ–≥–∏—á–Ω–æ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–∞ —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è –µ–¥–∏–Ω–∞ –¥–ª—è –æ–±–µ–∏—Ö –≥—Ä—É–ø–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

2.  **–ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π (`ultra`):**
    *   **–í—ã—è–≤–ª–µ–Ω —á–µ—Ç–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:** –û—Å–Ω–æ–≤–Ω–∞—è –º–∞—Å—Å–∞ –ø–æ–µ–∑–¥–æ–∫ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–∞ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ **2500‚Äì3500 –º–µ—Ç—Ä–æ–≤**, —á—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç **13‚Äì22 –º–∏–Ω—É—Ç—ã**.
    *   **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:** –≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ü–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–º –∏, –≤–æ–∑–º–æ–∂–Ω–æ, —Ä–µ–≥—É–ª—è—Ä–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –ø–æ–µ–∑–¥–æ–∫ —Å—Ä–µ–¥–Ω–µ–π –¥–ª–∏–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–µ–∑–¥–∫–∏ –Ω–∞ —Ä–∞–±–æ—Ç—É –∏–ª–∏ —É—á–µ–±—É). –ü–æ–≤–µ–¥–µ–Ω–∏–µ –¥–∞–Ω–Ω–æ–π –≥—Ä—É–ø–ø—ã –±–æ–ª–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ.

3.  **–ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏ (`free`):**
    *   **–ö–∞—Ä—Ç–∏–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–æ–ª–µ–µ —Ä–∞–∑–Ω–æ—Ä–æ–¥–Ω–∞:** –ù–∞–±–ª—é–¥–∞–µ—Ç—Å—è –±–æ–ª—å—à–µ "—Å–±–æ–µ–≤" –∏–ª–∏ –≤—ã–±—Ä–æ—Å–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö.
    *   **–ù–∞–∏–±–æ–ª—å—à–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –ø–æ–µ–∑–¥–æ–∫ (–¥–æ 1 –∫–º), –æ–¥–Ω–∞–∫–æ **—Å–∞–º–æ–π –ø–æ–ø—É–ª—è—Ä–Ω–æ–π –¥–∏—Å—Ç–∞–Ω—Ü–∏–µ–π** —è–≤–ª—è–µ—Ç—Å—è –¥–∏–∞–ø–∞–∑–æ–Ω **2‚Äì5 –∫–º**, –∑–∞–Ω–∏–º–∞—é—â–∏–π **10‚Äì25 –º–∏–Ω—É—Ç**.
    *   **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:** –ì—Ä—É–ø–ø–∞ –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Ä–≤–∏—Å –±–æ–ª–µ–µ —Å–ø–æ–Ω—Ç–∞–Ω–Ω–æ –∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ü–µ–ª–µ–π ‚Äî –∫–∞–∫ –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –±—ã—Å—Ç—Ä—ã—Ö –ø–æ–µ–∑–¥–æ–∫, —Ç–∞–∫ –∏ –¥–ª—è –±–æ–ª–µ–µ –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö.

## –ê–Ω–∞–ª–∏–∑ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
"""

data_users_riders_final['duration'] = np.ceil(data_users_riders_final['duration'])

data_new = data_users_riders_final.groupby(['user_id', 'month', 'subscription_type']).agg({
    'distance': ['sum'],
    'duration': ['count', 'sum']
}).reset_index()

data_new

data_new.columns = ['user_id', 'month', 'subscription_type','distance_sum', 'duration_count', 'duration_sum']

def revenue(row):
    if row['subscription_type'] == 'ultra':
        return row['duration_sum'] * 6 + 199
    else:
        return row['duration_sum'] * 8 + 50 * row['duration_count']

data_new['revenue'] = data_new.apply(revenue, axis=1)

data_new

tmp, col_rev = data_new.copy(), 'revenue'
print("–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—É–º–º—ã –≤—ã—Ä—É—á–∫–∏ 3878641, —Å—É–º–º–∞ –≤—ã—Ä—É—á–∫–∏ —Ä–∞—Å—á–∏—Ç–∞–Ω–Ω–∞—è –≤ —Ç–∞–±–ª–∏—Ü–µ:", tmp[col_rev].sum())

"""## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –≥–∏–ø–æ—Ç–µ–∑

6  –®–∞–≥ 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑
–ü—Ä–æ–¥–∞–∫—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä—ã —Å–µ—Ä–≤–∏—Å–∞ —Ö–æ—Ç—è—Ç —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π. –î–ª—è —ç—Ç–æ–≥–æ –æ–Ω–∏ –±—É–¥—É—Ç –ø—Ä–æ–≤–æ–¥–∏—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∞–∫—Ü–∏–∏, –Ω–æ —Å–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –≤—ã—è—Å–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞–∂–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤.

6.1 –í–∞–∂–Ω–æ –ø–æ–Ω—è—Ç—å, —Ç—Ä–∞—Ç—è—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –ø–æ–µ–∑–¥–∫–∏? –ï—Å–ª–∏ –¥–∞, —Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –º–æ–≥—É—Ç –±—ã—Ç—å ¬´–≤—ã–≥–æ–¥–Ω–µ–µ¬ª –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–∏–ø–æ—Ç–µ–∑—É. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–∏ ‚Äî –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –∏ —Ç–µ—Ö, —É –∫–æ–≥–æ –Ω–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∏.

–ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π —Ç—Ä–∞—Ç—è—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –ø–æ–µ–∑–¥–∫–∏"

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π —Ç—Ä–∞—Ç—è—Ç –º–µ–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –ø–æ–µ–∑–¥–∫–∏"

–ù–û–í–´–ï:

–ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –≤—ã–≥–æ–¥–Ω–µ–µ –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–∏"

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –Ω–µ –≤—ã–≥–æ–¥–Ω–µ–µ –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–∏"

–ù–û–í–´–ï 2

–ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π —Ç—Ä–∞—Ç—è—Ç —Å—Ç–æ–ª—å–∫–æ –∂–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –ø–æ–µ–∑–¥–∫–∏, —Å–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π —Ç—Ä–∞—Ç—è—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –ø–æ–µ–∑–¥–∫–∏, —á–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏
"""

alpha = 0.05
x = data_users_ultra['duration']
y = data_users_free['duration']
result_one = st.ttest_ind(x, y, alternative='greater')
result_one

if result_one.pvalue<alpha:
    print('–û—Ç–≤–µ—Ä–≥–∞–µ–º –≥–∏–ø–æ—Ç–µ–∑—É')
else:
    print('–ù–µ –æ—Ç–≤–µ—Ä–≥–∞–µ–º –≥–∏–ø–æ—Ç–µ–∑—É')

data_users_ultra['duration'].mean()

data_users_free['duration'].mean()

"""–ü–æ–ª—É—á–∞–µ—Ç—Å—è, –≤—Ä–µ–º—è –ø–æ–µ–∑–¥–∫–∏ –¥–≤—É—Ö –≤—ã–±–æ—Ä–æ–∫ –Ω–µ —Ä–∞–≤–Ω—ã. –ò –≤—Ä–µ–º—è –ø–æ–µ–∑–¥–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –±–æ–ª—å—à–µ, —á–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏.

–ü–æ–ª—É—á–∞–µ—Ç—Å—è, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –Ω–µ —Ç—Ä–∞—Ç—è—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏, –∫–∞—Ç–∞—è—Å—å –Ω–∞ —Å–∞–º–æ–∫–∞—Ç–∞—Ö, —á–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏.

6.2 –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ–¥–Ω–æ–π –ø–æ–µ–∑–¥–∫–∏ –≤ 3130 –º–µ—Ç—Ä–æ–≤ ‚Äî –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –∏–∑–Ω–æ—Å–∞ —Å–∞–º–æ–∫–∞—Ç–∞. –ú–æ–∂–Ω–æ –ª–∏ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ —Å—Ä–µ–¥–Ω–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–æ–µ–∑–∂–∞—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –∑–∞ –æ–¥–Ω—É –ø–æ–µ–∑–¥–∫—É, –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 3130 3130 –º–µ—Ç—Ä–æ–≤? –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–∏–ø–æ—Ç–µ–∑—É –∏ —Å–¥–µ–ª–∞–π—Ç–µ –≤—ã–≤–æ–¥—ã.

–ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π –ø–æ–µ–∑–¥–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –º–µ–Ω—å—à–µ 3130 –º–µ—Ç—Ä–æ–≤"

–ù–û–í–ê–Ø –ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: "–°—Ä–µ–¥–Ω—è—è –ø–æ–µ–∑–¥–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø–æ–¥–ø–∏—Å–∫–æ–π <= 3130 –º–µ—Ç—Ä–æ–≤"

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π –ø–æ–µ–∑–¥–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –±–æ–ª—å—à–µ 3130 –º–µ—Ç—Ä–æ–≤"
"""

alpha = 0.05
x = data_users_ultra['distance']
interesed = 3130
result_two = st.ttest_1samp(x,interesed, alternative='greater')
result_two

if result_two.pvalue<alpha:
    print('–û—Ç–≤–µ—Ä–≥–∞–µ–º –≥–∏–ø–æ—Ç–µ–∑—É')
else:
    print('–ù–µ –æ—Ç–≤–µ—Ä–≥–∞–µ–º –≥–∏–ø–æ—Ç–µ–∑—É')

"""–ü–æ–ª—É—á–∞–µ—Ç—Å—è, –º—ã –Ω–µ –º–æ–∂–µ–º –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –≥–∏–ø–æ—Ç–µ–∑—É –æ —Ç–æ–º, —á—Ç–æ –ø—Ä–µ–º–∏—É–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ —Å—Ä–µ–¥–Ω–µ–º –ø—Ä–æ–µ–∑–∂–∞—é—Ç –¥–æ 3130 –º–µ—Ç—Ä–æ–≤ –∑–∞ –ø–æ–µ–∑–¥–∫—É, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Ö –±–æ–ª–µ–µ —É–¥–æ–±–Ω—ã–º–∏ –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–∏, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–≤–æ–µ–º –Ω–µ –ø–æ–¥–≤–µ—Ä–≥–∞—é—Ç –∏–∑–Ω–æ—Å—É —Å–∞–º–æ–∫–∞—Ç.

6.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑—ã –æ —Ç–æ–º, –±—É–¥–µ—Ç –ª–∏ –ø–æ–º–µ—Å—è—á–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –ø–æ –º–µ—Å—è—Ü–∞–º –≤—ã—à–µ, —á–µ–º –≤—ã—Ä—É—á–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏.

–ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: "–ü–æ–º–µ—Å—è—á–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –ø–æ –º–µ—Å—è—Ü–∞–º –≤—ã—à–µ, —á–µ–º –≤—ã—Ä—É—á–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏"

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: "–ü–æ–º–µ—Å—è—á–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –ø–æ –º–µ—Å—è—Ü–∞–º –Ω–∏–∂–µ, —á–µ–º –≤—ã—Ä—É—á–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏"

–ù–û–í–´–ï

–ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: "–°—Ä–µ–¥–Ω–µ–µ –ø–æ–º–µ—Å—è—á–Ω–æ–π –≤—ã—Ä—É—á–∫–∏ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –ø–æ –º–µ—Å—è—Ü–∞–º –≤—ã—à–µ, —á–µ–º —Å—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏"

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: "–ü–æ–º–µ—Å—è—á–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ –º–µ—Å—è—Ü–∞–º –≤—ã—à–µ, —á–µ–º –≤—ã—Ä—É—á–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π"

–ù–û–í–´–ï 2

–ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: "–°—Ä–µ–¥–Ω—è—è –ø–æ–º–µ—Å—è—á–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π —Ä–∞–≤–Ω–∞ —Å—Ä–µ–¥–Ω–µ–π –≤—ã—Ä—É—á–∫–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏"

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: "–ü–æ–º–µ—Å—è—á–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –ø–æ –º–µ—Å—è—Ü–∞–º –≤—ã—à–µ, —á–µ–º –≤—ã—Ä—É—á–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏"
"""

alpha = 0.05
x = data_new[data_new['subscription_type']=='ultra']['revenue']
y = data_new[data_new['subscription_type']=='free']['revenue']
result_three = st.ttest_ind(x, y, alternative='greater')
result_three

if result_three.pvalue<alpha:
    print('–û—Ç–≤–µ—Ä–≥–∞–µ–º –≥–∏–ø–æ—Ç–µ–∑—É')
else:
    print('–ù–µ –æ—Ç–≤–µ—Ä–≥–∞–µ–º –≥–∏–ø–æ—Ç–µ–∑—É')

"""## –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –≤—ã–≤–æ–¥–æ–≤ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞ 2
–î–µ–ª–∞–µ–º –≤—ã–≤–æ–¥, –æ —Ç–æ–º, —á—Ç–æ —Å—Ä–µ–¥–Ω—è—è –ø–æ–º–µ—Å—è—á–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –Ω–µ —Ä–∞–≤–Ω–∞ —Å—Ä–µ–¥–Ω–µ–π –≤—ã—Ä—É—á–∫–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏.üëâ "–ù–µ —Ä–∞–≤–Ω–∞", –∞ "–±–æ–ª—å—à–µ".

–í—ã–≤–æ–¥ –ø–æ –¥–∞–Ω–Ω—ã–º —ç—Ç–æ–≥–æ –æ—Ç—Ä–µ–∑–∫–∞:

"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ —Ç—Ä–∞—Ç—è—Ç –Ω–∞ –ø–æ–µ–∑–¥–∫–∏" - –æ—Ç–≤–µ—Ä–≥–∞–µ–º –≥–∏–ø–æ—Ç–µ–∑—É

"–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π –ø–æ–µ–∑–¥–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –º–µ–Ω—å—à–µ 3130 –º–µ—Ç—Ä–æ–≤" - –Ω–µ –æ—Ç–≤–µ—Ä–≥–∞–µ–º –≥–∏–ø–æ—Ç–µ–∑—É

"–ü–æ–º–µ—Å—è—á–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –ø–æ –º–µ—Å—è—Ü–∞–º –≤—ã—à–µ, —á–µ–º –≤—ã—Ä—É—á–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏" - –æ—Ç–≤–µ—Ä–≥–∞–µ–º –≥–∏–ø–æ—Ç–µ–∑—É
–û–±—â–∏–π –≤—ã–≤–æ–¥: –ë—ã–ª–æ –∏–∑—É—á–µ–Ω–æ —Ç—Ä–∏ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ –ø–æ –ø—Ä–æ–∫–∞—Ç—É —Å–∞–º–æ–∫–∞—Ç–æ–≤ –∫–æ–º–ø–∞–Ω–∏–∏ GoFast.

–î–∞–Ω–Ω—ã–µ —á–∏—Å—Ç—ã–µ –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤. –î—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–µ–º–Ω–æ–≥–æ,–æ–Ω–∏ –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã. –î–∞–Ω–Ω—ã–µ –±–µ–∑ —Å–∏–ª—å–Ω—ã—Ö –≤—ã–±—Ä–æ—Å–æ–≤ –∏ –Ω–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫.

–í —Ä–∞–±–æ—Ç–µ –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å –æ–±—ä–µ–¥–∏–Ω—è—Ç—å –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—ã, –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º, –Ω–∞—Ö–æ–¥–∏—Ç—å –æ–±—â–µ–µ, —Å–æ–µ–¥–∏–Ω—è—Ç—å —Ç–∞–±–ª–∏—Ü—ã –ø–æ –Ω–∞–ª–∏—á–∏—é –ø–æ–¥–ø–∏—Å–∫–∏.

–í—ã—è—Å–Ω–∏–ª–∏ —Å–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –≥–æ—Ä–æ–¥ - –ü—è—Ç–∏–≥–æ—Ä—Å–∫, –≤–æ–∑—Ä–∞—Å—Ç 20-30, –≤—Ä–µ–º—è –≤ –ø—É—Ç–∏ 13-22 –º–∏–Ω—É—Ç, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ - 2500-3500 –º–µ—Ç—Ä–æ–≤ –∫–∞–∫ –¥–ª—è –ª—é–¥–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π, —Ç–∞–∫ –∏ –±–µ–∑. –í –∫–∞–∂–¥–æ–º –∏—Å—Å–ª–µ–¥—É–µ–º–æ–º –≥–æ—Ä–æ–¥–µ –±—ã–ª–æ –±–ª–∏–∑–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–∫–æ–ª–æ 170-220 —á–µ–ª–æ–≤–µ–∫.

–¢–∞–∫–∂–µ –≤–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –≤ –ø–µ—Ä–≤–æ–º –î–§(–ø—Ä–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) –º–µ–Ω—å—à–µ —Å—Ç—Ä–æ–∫, —á–µ–º –≤–æ –≤—Ç–æ—Ä–æ–º(–ø—Ä–æ –ø–æ–µ–∑–¥–∫–∏), —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –Ω–∞–º –æ —Ç–æ–º, —á—Ç–æ –ª—é–¥–∏ –¥–æ–≤–æ–ª—å–Ω–æ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–∞–º–æ–∫–∞—Ç—ã –∫–∞–∫ —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è.

–ù–µ –≤—Å–µ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –≥–∏–ø–æ—Ç–µ–∑—ã –±—ã–ª–∏ –Ω–µ –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—ã, –≤—Å–µ-—Ç–∞–∫–∏ –ø–æ–ª—É—á–∏–ª–æ—Å—å —Ç–∞–∫, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π —Ç—Ä–∞—Ç—è—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –ø–æ–µ–∑–¥–∫–∏ –∏ –ø–æ–º–µ—Å—è—á–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –ø–æ –º–µ—Å—è—Ü–∞–º –≤—ã—à–µ, —á–µ–º –≤—ã—Ä—É—á–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏, —Ç–∞–∫–∂–µ –≤—ã—è—Å–Ω–∏–ª–æ—Å—å, —á—Ç–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π –ø–æ–µ–∑–¥–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –º–µ–Ω—å—à–µ 3130 –º–µ—Ç—Ä–æ–≤, —á—Ç–æ –º–µ–Ω—å—à–µ –≤—Ä–µ–¥–∏—Ç —Å–∞–º–æ–∫–∞—Ç–∞, –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∏—Ö –±—ã—Å—Ç—Ä—ã–π –∏–∑–Ω–æ—Å. –≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –Ω–∞–º –æ –ø–æ–ª—å–∑–µ –∏ –≤—ã–≥–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–∞–º–∏.

–î–ª—è –±–æ–ª–µ–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∞–º–æ–∫–∞—Ç–∞–º–∏ –º–æ–∂–Ω–æ —Å–º–µ–ª–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –∞–∫—Ü–∏–∏ —Å –ø—Ä–æ–º–æ–∫–æ–¥–∞–º–∏, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å–æ–∫. –£–≤–µ–ª–∏—á–∏–≤–∞—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å–æ–∫ - –º—ã –ø—Ä–∏–≤–ª–µ–∫–∞–µ–º –±–æ–ª—å—à–µ –∏ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∑–Ω–∞–∫–æ–º–∏–º –∏—Ö —Å–æ —Å–≤–æ–∏–º–∏ —É—Å–ª—É–≥–∞–º–∏/—Ç–æ–≤–∞—Ä–æ–º.

–†–∞—Å–ø—Ä–µ–¥–µ–ª–Ω–∏—è
"""

k = 100
p = 0.1
n = 1000
distr = []
for k in range(0, n+1):
    choose = factorial(n)/(factorial(k)*factorial(n-k))
    prob = choose*p**k*(1-p)**(n-k)
    distr.append(prob)
plt.bar(range(0, n+1), distr)

distr_new = st.norm(1000, 100)
result = distr_new.cdf(k)
result
distr_new = st.norm(1200, 100)
result = distr_new.cdf(k)
result
distr_new = st.norm(1150, 100)
result = distr_new.cdf(k)
result
distr_new = st.norm(1175, 100)
result = distr_new.cdf(k)
result
distr_new = st.norm(1165, 100)
result = distr_new.cdf(k)
result
plt.title('–ì—Ä–∞—Ñ–∏–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è')
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–ª–µ–Ω–∏–π')
plt.ylabel('–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å')
plt.show()

p = 0.4
n = 1000000
x = 399500
mu = n*p
sigma = sqrt(mu*(1-p))
distr = st.norm(mu, sigma)

result = distr.cdf(x)


ax = plt.subplot()
ax.plot(x, binom.pmf(x,n,p), 'bo', ms=5)
ax.plot(x, norm.pdf(x, mu, sigma), 'r-', lw=3, alpha=0.3)
plt.xlabel('–ü–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫—Ä—ã—Ç–∏–π')
plt.show()
result

"""–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å 399500 —Ä–∞–≤–Ω–∞ 15,3%"""